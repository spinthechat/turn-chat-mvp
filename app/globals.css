@import "tailwindcss";

:root {
  --background: #fafaf9; /* stone-50 */
  --foreground: #1c1917; /* stone-900 */
  --card: #ffffff;
  --card-foreground: #1c1917;
  --muted: #f5f5f4; /* stone-100 */
  --muted-foreground: #78716c; /* stone-500 */
  --border: #e7e5e4; /* stone-200 */
  --input: #e7e5e4;
  --ring: #6366f1; /* indigo-500 */
  /* Dynamic viewport height fallback for iOS Safari */
  --vh: 1vh;
}

/* Dark mode colors */
.dark {
  --background: #1c1917; /* stone-900 */
  --foreground: #fafaf9; /* stone-50 */
  --card: #292524; /* stone-800 */
  --card-foreground: #fafaf9;
  --muted: #292524; /* stone-800 */
  --muted-foreground: #a8a29e; /* stone-400 */
  --border: #44403c; /* stone-700 */
  --input: #44403c;
  --ring: #818cf8; /* indigo-400 */
}

@theme inline {
  --color-background: var(--background);
  --color-foreground: var(--foreground);
  --font-sans: var(--font-geist-sans);
  --font-mono: var(--font-geist-mono);
}

/* ============================================
   Mobile Safari Fixes
   ============================================ */

/* Prevent Safari zoom on input focus - must be 16px+ */
@media screen and (max-width: 768px) {
  input,
  textarea,
  select {
    font-size: 16px !important;
  }
}

/* Use dynamic viewport height with fallback */
.h-screen-safe {
  height: 100vh; /* Fallback for older browsers */
  height: 100dvh; /* Dynamic viewport height - adjusts with keyboard */
}

/* For browsers that don't support dvh, use JS-set --vh */
@supports not (height: 100dvh) {
  .h-screen-safe {
    height: calc(var(--vh, 1vh) * 100);
  }
}

/* Safe area insets for notched devices */
.pb-safe {
  padding-bottom: env(safe-area-inset-bottom, 0px);
}

.pt-safe {
  padding-top: env(safe-area-inset-top, 0px);
}

/* Horizontal safe area padding with minimum values */
.px-safe {
  padding-left: max(1rem, env(safe-area-inset-left, 1rem));
  padding-right: max(1rem, env(safe-area-inset-right, 1rem));
}

/* ============================================
   Base Styles
   ============================================ */

html {
  scroll-behavior: smooth;
  /* Prevent pull-to-refresh and overscroll on mobile */
  overscroll-behavior: none;
  /* Ensure html fills viewport */
  height: 100%;
  /* Prevent any horizontal scrolling */
  overflow-x: hidden;
}

body {
  background: var(--background);
  color: var(--foreground);
  font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  /* Prevent text size adjustment on orientation change */
  -webkit-text-size-adjust: 100%;
  text-size-adjust: 100%;
  /* Fill viewport */
  height: 100%;
  /* Prevent body scroll - app handles its own scrolling */
  overflow: hidden;
  overflow-x: hidden;
  /* Fixed positioning context */
  position: fixed;
  width: 100%;
  max-width: 100vw;
}

/* ============================================
   Custom Animations
   ============================================ */

@keyframes fade-in {
  from { opacity: 0; }
  to { opacity: 1; }
}

@keyframes slide-in-from-bottom-2 {
  from {
    opacity: 0;
    transform: translateY(0.5rem);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

.animate-in {
  animation-duration: 200ms;
  animation-timing-function: cubic-bezier(0.16, 1, 0.3, 1);
  animation-fill-mode: both;
}

.fade-in {
  animation-name: fade-in;
}

.slide-in-from-bottom-2 {
  animation-name: slide-in-from-bottom-2;
}

.duration-200 {
  animation-duration: 200ms;
}

/* ============================================
   Focus & Selection
   ============================================ */

*:focus-visible {
  outline: 2px solid rgb(99 102 241 / 0.5);
  outline-offset: 2px;
}

::selection {
  background: rgb(99 102 241 / 0.2);
}

/* ============================================
   iOS Text Selection Prevention
   ============================================ */

/* Message bubble container - prevents iOS selection/callout */
.msg-bubble-container {
  -webkit-user-select: none;
  user-select: none;
  -webkit-touch-callout: none;
  -webkit-tap-highlight-color: transparent;
  touch-action: pan-y;
}

/* Message text wrapper - extra protection for text nodes */
.msg-text {
  -webkit-user-select: none;
  user-select: none;
  -webkit-touch-callout: none;
  -webkit-tap-highlight-color: transparent;
  pointer-events: none;
}

/* Re-enable pointer events for interactive elements inside */
.msg-text a,
.msg-text button {
  pointer-events: auto;
  -webkit-user-select: auto;
  user-select: auto;
}

/* Global no-select mode - applied when overlay is open */
.no-select,
.no-select * {
  -webkit-user-select: none !important;
  user-select: none !important;
  -webkit-touch-callout: none !important;
}

/* Exclude inputs from no-select */
.no-select input,
.no-select textarea {
  -webkit-user-select: text !important;
  user-select: text !important;
}

/* ============================================
   Dark Mode Utilities
   ============================================ */

/* Common background patterns for dark mode */
.dark .bg-white {
  background-color: var(--card);
}

.dark .bg-stone-50 {
  background-color: var(--background);
}

.dark .bg-stone-100 {
  background-color: var(--muted);
}

/* Text colors */
.dark .text-stone-900 {
  color: var(--foreground);
}

.dark .text-stone-700 {
  color: #d6d3d1; /* stone-300 */
}

.dark .text-stone-600 {
  color: #a8a29e; /* stone-400 */
}

.dark .text-stone-500 {
  color: var(--muted-foreground);
}

.dark .text-stone-400 {
  color: #78716c; /* stone-500 */
}

/* Borders */
.dark .border-stone-200 {
  border-color: var(--border);
}

.dark .border-stone-100 {
  border-color: #3a3632;
}

.dark .ring-stone-200 {
  --tw-ring-color: var(--border);
}

/* Hover states */
.dark .hover\:bg-stone-50:hover {
  background-color: #292524;
}

.dark .hover\:bg-stone-100:hover {
  background-color: var(--muted);
}

/* Focus ring for dark mode */
.dark *:focus-visible {
  outline-color: var(--ring);
}

/* Selection in dark mode */
.dark ::selection {
  background: rgb(129 140 248 / 0.3);
}
