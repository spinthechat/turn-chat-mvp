@import "tailwindcss";

:root {
  --background: #fafaf9; /* stone-50 */
  --foreground: #1c1917; /* stone-900 */
  --card: #ffffff;
  --card-foreground: #1c1917;
  --muted: #f5f5f4; /* stone-100 */
  --muted-foreground: #78716c; /* stone-500 */
  --border: #e7e5e4; /* stone-200 */
  --input: #e7e5e4;
  --ring: #6366f1; /* indigo-500 */
  /* Dynamic viewport height fallback for iOS Safari */
  --vh: 1vh;
}

/* Dark mode colors */
.dark {
  --background: #1c1917; /* stone-900 */
  --foreground: #fafaf9; /* stone-50 */
  --card: #292524; /* stone-800 */
  --card-foreground: #fafaf9;
  --muted: #292524; /* stone-800 */
  --muted-foreground: #a8a29e; /* stone-400 */
  --border: #44403c; /* stone-700 */
  --input: #44403c;
  --ring: #818cf8; /* indigo-400 */
}

@theme inline {
  --color-background: var(--background);
  --color-foreground: var(--foreground);
  --font-sans: var(--font-geist-sans);
  --font-mono: var(--font-geist-mono);
}

/* ============================================
   Mobile Safari Fixes
   ============================================ */

/* Prevent Safari zoom on input focus - must be 16px+ */
@media screen and (max-width: 768px) {
  input,
  textarea,
  select {
    font-size: 16px !important;
  }
}

/* Use dynamic viewport height with fallback */
.h-screen-safe {
  height: 100vh; /* Fallback for older browsers */
  height: 100dvh; /* Dynamic viewport height - adjusts with keyboard */
}

/* For browsers that don't support dvh, use JS-set --vh */
@supports not (height: 100dvh) {
  .h-screen-safe {
    height: calc(var(--vh, 1vh) * 100);
  }
}

/* Safe area insets for notched devices */
.pb-safe {
  padding-bottom: env(safe-area-inset-bottom, 0px);
}

.pt-safe {
  padding-top: env(safe-area-inset-top, 0px);
}

/* Horizontal safe area padding with minimum values */
.px-safe {
  padding-left: max(1rem, env(safe-area-inset-left, 1rem));
  padding-right: max(1rem, env(safe-area-inset-right, 1rem));
}

/* ============================================
   Base Styles
   ============================================ */

html {
  scroll-behavior: smooth;
  /* Prevent pull-to-refresh and overscroll on mobile */
  overscroll-behavior: none;
  /* Ensure html fills viewport */
  height: 100%;
  /* Prevent any horizontal scrolling */
  overflow-x: hidden;
}

body {
  background: var(--background);
  color: var(--foreground);
  font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  /* Prevent text size adjustment on orientation change */
  -webkit-text-size-adjust: 100%;
  text-size-adjust: 100%;
  /* Fill viewport */
  height: 100%;
  /* Prevent body scroll - app handles its own scrolling */
  overflow: hidden;
  overflow-x: hidden;
  /* Fixed positioning context */
  position: fixed;
  width: 100%;
  max-width: 100vw;
}

/* ============================================
   Custom Animations
   ============================================ */

@keyframes fade-in {
  from { opacity: 0; }
  to { opacity: 1; }
}

/* Turn Pulse - subtle live indicator dot animation */
@keyframes pulse-opacity {
  0%, 100% { opacity: 0.4; }
  50% { opacity: 1; }
}

@keyframes slide-in-from-bottom-2 {
  from {
    opacity: 0;
    transform: translateY(0.5rem);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

.animate-in {
  animation-duration: 200ms;
  animation-timing-function: cubic-bezier(0.16, 1, 0.3, 1);
  animation-fill-mode: both;
}

.fade-in {
  animation-name: fade-in;
}

.slide-in-from-bottom-2 {
  animation-name: slide-in-from-bottom-2;
}

.duration-200 {
  animation-duration: 200ms;
}

/* ============================================
   Focus & Selection
   ============================================ */

*:focus-visible {
  outline: 2px solid rgb(99 102 241 / 0.5);
  outline-offset: 2px;
}

::selection {
  background: rgb(99 102 241 / 0.2);
}

/* ============================================
   iOS Text Selection Prevention
   ============================================ */

/* Message bubble container - prevents iOS selection/callout */
.msg-bubble-container {
  -webkit-user-select: none;
  user-select: none;
  -webkit-touch-callout: none;
  -webkit-tap-highlight-color: transparent;
  touch-action: pan-y;
}

/* Message text wrapper - extra protection for text nodes */
.msg-text {
  -webkit-user-select: none;
  user-select: none;
  -webkit-touch-callout: none;
  -webkit-tap-highlight-color: transparent;
  pointer-events: none;
}

/* Re-enable pointer events for interactive elements inside */
.msg-text a,
.msg-text button {
  pointer-events: auto;
  -webkit-user-select: auto;
  user-select: auto;
}

/* Global no-select mode - applied when overlay is open */
.no-select,
.no-select * {
  -webkit-user-select: none !important;
  user-select: none !important;
  -webkit-touch-callout: none !important;
}

/* Exclude inputs from no-select */
.no-select input,
.no-select textarea {
  -webkit-user-select: text !important;
  user-select: text !important;
}

/* ============================================
   Dark Mode Utilities
   ============================================ */

/* Common background patterns for dark mode */
.dark .bg-white {
  background-color: var(--card);
}

.dark .bg-stone-50 {
  background-color: var(--background);
}

.dark .bg-stone-100 {
  background-color: var(--muted);
}

/* Text colors */
.dark .text-stone-900 {
  color: var(--foreground);
}

.dark .text-stone-700 {
  color: #d6d3d1; /* stone-300 */
}

.dark .text-stone-600 {
  color: #a8a29e; /* stone-400 */
}

.dark .text-stone-500 {
  color: var(--muted-foreground);
}

.dark .text-stone-400 {
  color: #78716c; /* stone-500 */
}

/* Borders */
.dark .border-stone-200 {
  border-color: var(--border);
}

.dark .border-stone-100 {
  border-color: #3a3632;
}

.dark .ring-stone-200 {
  --tw-ring-color: var(--border);
}

/* Hover states */
.dark .hover\:bg-stone-50:hover {
  background-color: #292524;
}

.dark .hover\:bg-stone-100:hover {
  background-color: var(--muted);
}

/* Focus ring for dark mode */
.dark *:focus-visible {
  outline-color: var(--ring);
}

/* Selection in dark mode */
.dark ::selection {
  background: rgb(129 140 248 / 0.3);
}

/* ============================================
   Slate Color Dark Mode Overrides
   ============================================ */

/* Slate text colors - mapped to readable dark mode equivalents */
.dark .text-slate-900 {
  color: #f8fafc; /* slate-50 */
}

.dark .text-slate-800 {
  color: #f1f5f9; /* slate-100 */
}

.dark .text-slate-700 {
  color: #e2e8f0; /* slate-200 */
}

.dark .text-slate-600 {
  color: #cbd5e1; /* slate-300 */
}

.dark .text-slate-500 {
  color: #94a3b8; /* slate-400 */
}

.dark .text-slate-400 {
  color: #94a3b8; /* slate-400 - boost for readability */
}

.dark .text-slate-300 {
  color: #64748b; /* slate-500 - subdued */
}

/* Slate background colors */
.dark .bg-slate-50 {
  background-color: #1e293b; /* slate-800 */
}

.dark .bg-slate-100 {
  background-color: #1e293b; /* slate-800 */
}

.dark .bg-slate-100\/80 {
  background-color: rgba(30, 41, 59, 0.8);
}

.dark .bg-slate-50\/80 {
  background-color: rgba(30, 41, 59, 0.8);
}

.dark .bg-slate-50\/50 {
  background-color: rgba(30, 41, 59, 0.5);
}

.dark .bg-slate-200 {
  background-color: #334155; /* slate-700 */
}

/* Slate border colors */
.dark .border-slate-200 {
  border-color: #475569; /* slate-600 */
}

.dark .border-slate-100 {
  border-color: #334155; /* slate-700 */
}

.dark .border-slate-200\/40,
.dark .border-slate-200\/50 {
  border-color: rgba(71, 85, 105, 0.4);
}

/* Slate ring colors */
.dark .ring-slate-200 {
  --tw-ring-color: #475569;
}

.dark .ring-slate-200\/50,
.dark .ring-slate-200\/80 {
  --tw-ring-color: rgba(71, 85, 105, 0.5);
}

.dark .ring-slate-100 {
  --tw-ring-color: #334155;
}

/* Slate hover states */
.dark .hover\:bg-slate-50:hover {
  background-color: #334155;
}

.dark .hover\:bg-slate-100:hover {
  background-color: #334155;
}

.dark .hover\:text-slate-900:hover {
  color: #f8fafc;
}

.dark .hover\:text-slate-600:hover {
  color: #cbd5e1;
}

/* ============================================
   Purple/Violet/Indigo Dark Mode Overrides
   ============================================ */

/* Indigo - shift to lighter variants */
.dark .text-indigo-600 {
  color: #a5b4fc; /* indigo-300 */
}

.dark .text-indigo-500 {
  color: #a5b4fc; /* indigo-300 */
}

.dark .text-indigo-400 {
  color: #c7d2fe; /* indigo-200 */
}

/* Violet - shift to lighter variants */
.dark .text-violet-600 {
  color: #c4b5fd; /* violet-300 */
}

.dark .text-violet-500 {
  color: #c4b5fd; /* violet-300 */
}

.dark .text-violet-400 {
  color: #ddd6fe; /* violet-200 */
}

/* Purple - shift to lighter variants */
.dark .text-purple-600 {
  color: #d8b4fe; /* purple-300 */
}

.dark .text-purple-500 {
  color: #d8b4fe; /* purple-300 */
}

.dark .text-purple-400 {
  color: #e9d5ff; /* purple-200 */
}

/* Rose/Pink for accent text */
.dark .text-rose-600 {
  color: #fda4af; /* rose-300 */
}

.dark .text-rose-500 {
  color: #fda4af; /* rose-300 */
}

.dark .text-pink-600 {
  color: #f9a8d4; /* pink-300 */
}

.dark .text-pink-500 {
  color: #f9a8d4; /* pink-300 */
}

/* ============================================
   Additional Dark Mode Edge Cases
   ============================================ */

/* Ring colors for indicators */
.dark .ring-white {
  --tw-ring-color: #292524; /* stone-800 - matches dark card bg */
}

/* Gradient backgrounds */
.dark .from-slate-100 {
  --tw-gradient-from: #334155; /* slate-700 */
}

.dark .to-slate-50 {
  --tw-gradient-to: #1e293b; /* slate-800 */
}

.dark .from-slate-50 {
  --tw-gradient-from: #1e293b;
}

/* Backdrop/overlay backgrounds */
.dark .bg-white\/95 {
  background-color: rgba(41, 37, 36, 0.95); /* stone-800 with alpha */
}

.dark .bg-white\/80 {
  background-color: rgba(41, 37, 36, 0.8);
}

.dark .bg-white\/85 {
  background-color: rgba(41, 37, 36, 0.85);
}

.dark .bg-white\/90 {
  background-color: rgba(41, 37, 36, 0.9);
}

/* Divide colors */
.dark .divide-stone-100 > :not([hidden]) ~ :not([hidden]) {
  border-color: #44403c; /* stone-700 */
}

.dark .divide-stone-100\/50 > :not([hidden]) ~ :not([hidden]) {
  border-color: rgba(68, 64, 60, 0.5);
}

.dark .divide-slate-100 > :not([hidden]) ~ :not([hidden]) {
  border-color: #334155; /* slate-700 */
}

/* Active states */
.dark .active\:bg-slate-100:active {
  background-color: #475569; /* slate-600 */
}

.dark .active\:bg-stone-100:active {
  background-color: #44403c; /* stone-700 */
}

/* ============================================
   Chat Room Theme Overlays
   ============================================ */

/* Base theme container */
.chat-theme-container {
  position: relative;
}

.chat-theme-container::before {
  content: '';
  position: absolute;
  inset: 0;
  pointer-events: none;
  z-index: 0;
  opacity: 0;
  transition: opacity 0.5s ease-out;
}

/* FAMILY theme - warm family silhouette */
.chat-theme-container.theme-family::before {
  opacity: 0.045;
  background:
    radial-gradient(ellipse 60% 40% at 50% 85%, rgba(217, 119, 6, 0.08) 0%, transparent 70%),
    url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 200 100' fill='%23b45309' opacity='0.4'%3E%3Cellipse cx='70' cy='75' rx='12' ry='20'/%3E%3Cellipse cx='100' cy='70' rx='14' ry='24'/%3E%3Cellipse cx='130' cy='75' rx='12' ry='20'/%3E%3Cellipse cx='85' cy='80' rx='8' ry='14'/%3E%3Cellipse cx='115' cy='80' rx='8' ry='14'/%3E%3Ccircle cx='70' cy='52' r='8'/%3E%3Ccircle cx='100' cy='44' r='10'/%3E%3Ccircle cx='130' cy='52' r='8'/%3E%3Ccircle cx='85' cy='62' r='6'/%3E%3Ccircle cx='115' cy='62' r='6'/%3E%3C/svg%3E") no-repeat center 95% / 280px auto;
}

/* FLIRTY theme - moody bar ambience */
.chat-theme-container.theme-flirty::before {
  opacity: 0.06;
  background:
    radial-gradient(ellipse 80% 50% at 30% 90%, rgba(244, 63, 94, 0.12) 0%, transparent 50%),
    radial-gradient(ellipse 60% 40% at 70% 85%, rgba(168, 85, 247, 0.08) 0%, transparent 50%),
    radial-gradient(circle at 25% 80%, rgba(251, 191, 36, 0.06) 0%, transparent 30%),
    radial-gradient(circle at 75% 85%, rgba(251, 191, 36, 0.04) 0%, transparent 25%);
}

/* COUPLE theme - intertwining abstract shapes */
.chat-theme-container.theme-couple::before {
  opacity: 0.05;
  background:
    radial-gradient(ellipse 50% 60% at 50% 90%, rgba(236, 72, 153, 0.1) 0%, transparent 60%),
    url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 200 120' fill='none' stroke='%23ec4899' stroke-width='1.5' opacity='0.5'%3E%3Cpath d='M60 100 Q80 60 100 80 Q120 100 100 60 Q80 20 60 60 Q40 100 60 100Z'/%3E%3Cpath d='M140 100 Q120 60 100 80 Q80 100 100 60 Q120 20 140 60 Q160 100 140 100Z'/%3E%3C/svg%3E") no-repeat center 92% / 200px auto;
}

/* DEEP theme - no illustration, just subtle depth gradient */
.chat-theme-container.theme-deep::before {
  opacity: 0.03;
  background: linear-gradient(to bottom,
    transparent 0%,
    rgba(59, 130, 246, 0.04) 50%,
    rgba(99, 102, 241, 0.06) 100%
  );
}

/* ============================================
   Flirty Theme Dark Mode Overrides
   ============================================ */

.chat-theme-container.theme-flirty {
  color-scheme: dark;
}

/* Override light backgrounds for flirty mode */
.theme-flirty .bg-white {
  background-color: rgba(30, 27, 36, 0.95);
}

.theme-flirty .bg-white\/80,
.theme-flirty .bg-white\/85,
.theme-flirty .bg-white\/90 {
  background-color: rgba(30, 27, 36, 0.85);
}

.theme-flirty .bg-slate-100\/80,
.theme-flirty .bg-slate-100 {
  background-color: rgba(45, 40, 52, 0.8);
}

.theme-flirty .bg-slate-50\/80 {
  background-color: rgba(35, 32, 42, 0.8);
}

/* Text colors for flirty */
.theme-flirty .text-slate-900 {
  color: #f8fafc;
}

.theme-flirty .text-slate-700 {
  color: #cbd5e1;
}

.theme-flirty .text-slate-600 {
  color: #94a3b8;
}

.theme-flirty .text-slate-500 {
  color: #64748b;
}

.theme-flirty .text-slate-400 {
  color: #94a3b8;
}

/* Borders for flirty */
.theme-flirty .border-slate-200\/40,
.theme-flirty .border-slate-200\/50 {
  border-color: rgba(148, 163, 184, 0.15);
}

.theme-flirty .ring-slate-200\/80,
.theme-flirty .ring-slate-200\/50 {
  --tw-ring-color: rgba(148, 163, 184, 0.2);
}

/* Message bubbles for flirty - keep readable */
.theme-flirty .msg-bubble-other {
  background-color: rgba(45, 40, 52, 0.95);
  color: #f1f5f9;
}

/* Input styling for flirty */
.theme-flirty input::placeholder {
  color: rgba(148, 163, 184, 0.6);
}

/* ============================================
   Theme Accent Color Utilities
   ============================================ */

/* Family accent colors */
.theme-family .theme-accent-text { color: rgb(180 83 9); }
.theme-family .theme-accent-bg { background-color: rgb(245 158 11); }
.theme-family .theme-accent-ring { --tw-ring-color: rgb(251 191 36 / 0.6); }

/* Flirty accent colors */
.theme-flirty .theme-accent-text { color: rgb(251 113 133); }
.theme-flirty .theme-accent-bg { background-color: rgb(244 63 94); }
.theme-flirty .theme-accent-ring { --tw-ring-color: rgb(251 113 133 / 0.5); }

/* Deep accent colors */
.theme-deep .theme-accent-text { color: rgb(37 99 235); }
.theme-deep .theme-accent-bg { background-color: rgb(59 130 246); }
.theme-deep .theme-accent-ring { --tw-ring-color: rgb(96 165 250 / 0.5); }

/* Couple accent colors */
.theme-couple .theme-accent-text { color: rgb(219 39 119); }
.theme-couple .theme-accent-bg { background-color: rgb(236 72 153); }
.theme-couple .theme-accent-ring { --tw-ring-color: rgb(244 114 182 / 0.5); }
